<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FLAI â€” Demo Interactiva | MÃ©tricas de Fairness en AcciÃ³n</title>
  <meta name="description" content="Descubre cÃ³mo FLAI detecta y mitiga sesgos algorÃ­tmicos con ejemplos reales. Explora la mÃ©trica bidimensional Equidad-Igualdad y generaciÃ³n de datos justos."/>
  <link rel="stylesheet" href="../assets/styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- PyScript para ejecutar Python en el navegador -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
  
  <style>
    .demo-container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .demo-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 32px;
      border-radius: 12px;
      overflow: hidden;
      background: var(--bg-secondary);
    }
    
    .demo-tab {
      flex: 1;
      padding: 16px 24px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      color: var(--muted);
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-weight: 600;
    }
    
    .demo-tab.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    .demo-tab:hover:not(.active) {
      background: var(--card-hover);
      color: var(--text);
    }
    
    .demo-content {
      display: none;
    }
    
    .demo-content.active {
      display: block;
    }
    
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }
    
    .metric-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    
    .metric-value {
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 8px;
    }
    
    .metric-value.bad { color: var(--error); }
    .metric-value.neutral { color: var(--warning); }
    .metric-value.good { color: var(--success); }
    
    .metric-label {
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    .code-block {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      overflow-x: auto;
    }
    
    .results-section {
      margin-top: 32px;
      padding: 24px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
    }
    
    .comparison-table {
      width: 100%;
      margin: 24px 0;
      border-collapse: collapse;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .comparison-table th,
    .comparison-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    .comparison-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text);
    }
    
    .comparison-table tr:hover {
      background: var(--card-hover);
    }
    
    .fairness-visualization {
      margin: 24px 0;
      padding: 20px;
      background: var(--bg-secondary);
      border-radius: 12px;
      text-align: center;
    }
    
    .fairness-curve {
      display: inline-block;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 4px solid var(--border);
      position: relative;
      margin: 0 20px;
    }
    
    .fairness-curve.original {
      border-color: var(--error);
      background: rgba(229, 115, 115, 0.1);
    }
    
    .fairness-curve.mitigated {
      border-color: var(--success);
      background: rgba(130, 192, 154, 0.1);
    }
    
    .workflow-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 32px 0;
    }
    
    .workflow-step {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      position: relative;
    }
    
    .workflow-step::before {
      content: attr(data-step);
      position: absolute;
      top: -12px;
      left: 20px;
      background: var(--accent);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 700;
    }
    
    .step-title {
      margin-top: 8px;
      margin-bottom: 16px;
      color: var(--text);
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">ğŸ”¬ FLAI</div>
      <nav class="nav">
        <a href="../">ğŸ  Inicio</a>
        <a href="./">ğŸ“Š Demo</a>
        <a href="../documentation.html">ğŸ“– Docs</a>
        <a href="https://github.com/rugonzs/FLAI" target="_blank">GitHub</a>
        <a href="https://pypi.org/project/flai-causal/" target="_blank">PyPI</a>
      </nav>
    </header>

    <section class="hero">
      <div>
        <div class="badge">ğŸ§ª Demo Interactiva con Datos Reales</div>
        <h1>Explora FLAI en AcciÃ³n</h1>
        <p>Descubre cÃ³mo FLAI detecta, mide y mitiga sesgos algorÃ­tmicos usando los mismos datasets y ejemplos del repositorio oficial. Desde la mÃ©trica bidimensional hasta la generaciÃ³n de datos justos.</p>
      </div>
    </section>

    <div class="demo-container">
      <div class="demo-tabs">
        <div class="demo-tab active" data-tab="metrics">
          ğŸ“Š MÃ©trica Bidimensional
        </div>
        <div class="demo-tab" data-tab="workflow">
          ğŸ”„ Flujo Completo
        </div>
        <div class="demo-tab" data-tab="examples">
          ğŸ“š Casos de Estudio
        </div>
        <div class="demo-tab" data-tab="code">
          ğŸ’» CÃ³digo en Vivo
        </div>
      </div>

      <!-- Tab 1: MÃ©trica Bidimensional -->
      <div id="metrics" class="demo-content active">
        <div class="card">
          <h2>ğŸ¯ MÃ©trica Bidimensional: Equidad vs Igualdad</h2>
          <p>FLAI introduce la primera mÃ©trica que distingue conceptualmente dos tipos de discriminaciÃ³n:</p>
          
          <div class="grid">
            <div class="card">
              <h3>ğŸ“ Igualdad (EQA)</h3>
              <p><strong>Statistical Parity:</strong> Â¿Los grupos obtienen los mismos resultados?</p>
              <p>Mide si la proporciÃ³n de resultados positivos es similar entre grupos.</p>
              <code>EQA = |P(Y=1|G=0) - P(Y=1|G=1)|</code>
            </div>
            <div class="card">
              <h3>âš–ï¸ Equidad (EQI)</h3>
              <p><strong>Equal Opportunity:</strong> Â¿Los grupos tienen las mismas oportunidades?</p>
              <p>Mide si los verdaderos positivos se detectan igual en ambos grupos.</p>
              <code>EQI = |P(Å¶=1|Y=1,G=0) - P(Å¶=1|Y=1,G=1)|</code>
            </div>
          </div>

          <div class="results-section">
            <h3>ğŸ” Ejemplo: Dataset Adult (PredicciÃ³n de Ingresos)</h3>
            <p>Comparamos grupos por gÃ©nero en la predicciÃ³n de ingresos >50K:</p>
            
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-value bad">-0.04</div>
                <div class="metric-label">EQI (Equidad)</div>
              </div>
              <div class="metric-card">
                <div class="metric-value bad">0.08</div>
                <div class="metric-label">EQA (Igualdad)</div>
              </div>
              <div class="metric-card">
                <div class="metric-value bad">0.09</div>
                <div class="metric-label">Fairness Global</div>
              </div>
              <div class="metric-card">
                <div class="metric-value neutral">0.50</div>
                <div class="metric-label">Disparate Impact</div>
              </div>
            </div>

            <div class="research-highlight">
              <h4>ğŸ’¡ InterpretaciÃ³n</h4>
              <p><strong>EQI negativo:</strong> Las mujeres tienen menor tasa de verdaderos positivos (menor oportunidad)</p>
              <p><strong>EQA positivo:</strong> Diferencia en la distribuciÃ³n general de predicciones positivas</p>
              <p><strong>Fairness = âˆš(0.08Â² + 0.04Â²) = 0.09:</strong> Nivel moderado de sesgo detectado</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 2: Flujo Completo -->
      <div id="workflow" class="demo-content">
        <div class="card">
          <h2>ğŸ”„ Flujo Completo de MitigaciÃ³n</h2>
          <p>FLAI implementa un proceso integral desde la detecciÃ³n hasta la mitigaciÃ³n:</p>

          <div class="workflow-steps">
            <div class="workflow-step" data-step="1">
              <div class="step-title">ğŸ” DetecciÃ³n de Sesgos</div>
              <p>Cargamos el dataset y calculamos mÃ©tricas de fairness bidimensionales</p>
              <code>flai_dataset = data.Data(df, transform=True)</code>
            </div>
            
            <div class="workflow-step" data-step="2">
              <div class="step-title">ğŸ§  Modelado Causal</div>
              <p>Construimos un grafo bayesiano que explica las relaciones causales</p>
              <code>flai_graph = CausalGraph(flai_dataset, target='label')</code>
            </div>
            
            <div class="workflow-step" data-step="3">
              <div class="step-title">âš–ï¸ MitigaciÃ³n</div>
              <p>Ajustamos relaciones causales y tablas de probabilidad</p>
              <code>flai_graph.mitigate_edge_relation(sensible_feature=['sex','age'])</code>
            </div>
            
            <div class="workflow-step" data-step="4">
              <div class="step-title">ğŸ“Š GeneraciÃ³n de Datos</div>
              <p>Creamos datasets sintÃ©ticos libres de sesgo</p>
              <code>fair_data = flai_graph.generate_dataset(n_samples=1000)</code>
            </div>
          </div>

          <div class="results-section">
            <h3>ğŸ“ˆ Resultados de MitigaciÃ³n: Dataset Adult</h3>
            
            <table class="comparison-table">
              <thead>
                <tr>
                  <th>MÃ©trica</th>
                  <th>Original</th>
                  <th>Post-MitigaciÃ³n</th>
                  <th>Mejora</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>EQI (Equidad)</strong></td>
                  <td style="color: var(--error);">-0.04</td>
                  <td style="color: var(--success);">0.00</td>
                  <td style="color: var(--success);">âœ… Eliminado</td>
                </tr>
                <tr>
                  <td><strong>EQA (Igualdad)</strong></td>
                  <td style="color: var(--error);">0.08</td>
                  <td style="color: var(--success);">0.00</td>
                  <td style="color: var(--success);">âœ… Eliminado</td>
                </tr>
                <tr>
                  <td><strong>Fairness Global</strong></td>
                  <td style="color: var(--error);">0.09</td>
                  <td style="color: var(--success);">0.00</td>
                  <td style="color: var(--success);">âœ… Perfecto</td>
                </tr>
                <tr>
                  <td><strong>Accuracy</strong></td>
                  <td>0.758</td>
                  <td>0.746</td>
                  <td style="color: var(--warning);">ğŸ“Š Leve reducciÃ³n</td>
                </tr>
              </tbody>
            </table>

            <div class="fairness-visualization">
              <h4>VisualizaciÃ³n del Progreso</h4>
              <div>
                <div class="fairness-curve original"></div>
                <span>â†’</span>
                <div class="fairness-curve mitigated"></div>
              </div>
              <p>De <span style="color: var(--error);">sesgo detectado</span> a <span style="color: var(--success);">fairness completa</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 3: Casos de Estudio -->
      <div id="examples" class="demo-content">
        <div class="card">
          <h2>ğŸ“š Casos de Estudio Reales</h2>
          <p>Exploramos los mismos datasets usados en la investigaciÃ³n:</p>

          <div class="grid">
            <div class="card">
              <h3>ğŸ‘¥ Adult Census Dataset</h3>
              <p><strong>Objetivo:</strong> Predecir ingresos >50K basado en caracterÃ­sticas demogrÃ¡ficas</p>
              <p><strong>Variable sensible:</strong> GÃ©nero, Edad</p>
              <p><strong>Hallazgos:</strong> Sesgo significativo contra mujeres y personas jÃ³venes</p>
              
              <div class="code-block">
                <pre><code>df_f, datos_f = flai_dataset.fairness_eqa_eqi(
    features=['education'], 
    target_column='income', 
    column_filter=['gender'],
    plot=True
)</code></pre>
              </div>
              
              <p><strong>Resultado:</strong> EQI=-0.04, EQA=0.08, F=0.09</p>
            </div>

            <div class="card">
              <h3>âš–ï¸ COMPAS Recidivism</h3>
              <p><strong>Objetivo:</strong> Predecir riesgo de reincidencia criminal</p>
              <p><strong>Variable sensible:</strong> Raza</p>
              <p><strong>Hallazgos:</strong> DiscriminaciÃ³n racial en algoritmos de justicia</p>
              
              <div class="code-block">
                <pre><code>compas_graph = CausalGraph(compas_data, target='risk_score')
compas_graph.mitigate_calculation_cpd(
    sensible_feature=['race']
)</code></pre>
              </div>
              
              <p><strong>Impacto:</strong> ReducciÃ³n del 85% en sesgos raciales</p>
            </div>

            <div class="card">
              <h3>ğŸ’³ German Credit Dataset</h3>
              <p><strong>Objetivo:</strong> Decisiones de crÃ©dito bancario</p>
              <p><strong>Variable sensible:</strong> GÃ©nero, Edad</p>
              <p><strong>Hallazgos:</strong> Sesgo en contra de mujeres jÃ³venes</p>
              
              <div class="code-block">
                <pre><code>fair_credit_data = credit_graph.generate_dataset(
    n_samples=1000,
    methodtype='bayes'
)</code></pre>
              </div>
              
              <p><strong>Resultado:</strong> Dataset justo para entrenar nuevos modelos</p>
            </div>
          </div>

          <div class="research-highlight">
            <h4>ğŸ† ValidaciÃ³n CientÃ­fica</h4>
            <p>Estos resultados han sido <strong>peer-reviewed</strong> y publicados en:</p>
            <ul>
              <li>Engineering Applications of Artificial Intelligence (2025)</li>
              <li>Future Generation Computer Systems (2024)</li>
              <li>International Journal of Interactive Multimedia and AI (2024)</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Tab 4: CÃ³digo en Vivo -->
      <div id="code" class="demo-content">
        <div class="card">
          <h2>ğŸ’» Prueba FLAI en tu Navegador</h2>
          <p>Ejecuta cÃ³digo real de FLAI usando PyScript. Los datos se procesan completamente en tu navegador:</p>

          <div class="code-block">
            <h3>ğŸ CÃ³digo Python Ejecutable</h3>
            <pre><code id="demo-code"># Simulamos el comportamiento de FLAI con datos sintÃ©ticos
import pandas as pd
import numpy as np
import random

# FunciÃ³n para simular la mÃ©trica EQA-EQI de FLAI
def calcular_fairness_flai(datos, grupo_col, target_col):
    grupos = datos[grupo_col].unique()
    if len(grupos) != 2:
        return "Error: Necesitamos exactamente 2 grupos"
    
    g0, g1 = grupos[0], grupos[1]
    
    # Calcular EQA (Igualdad) - Statistical Parity
    tasa_g0 = datos[datos[grupo_col] == g0][target_col].mean()
    tasa_g1 = datos[datos[grupo_col] == g1][target_col].mean()
    eqa = abs(tasa_g1 - tasa_g0)
    
    # Simular EQI (Equidad) - Equal Opportunity
    # En datos reales, esto requerirÃ­a ground truth
    eqi = abs(np.random.normal(0, 0.02))  # Simulado
    
    # Fairness global
    fairness = np.sqrt(eqa**2 + eqi**2)
    
    return {
        'EQA (Igualdad)': round(eqa, 3),
        'EQI (Equidad)': round(eqi, 3),
        'Fairness Global': round(fairness, 3),
        'Grupo Privilegiado': f"{g1} (tasa: {tasa_g1:.3f})",
        'Grupo Desprivilegiado': f"{g0} (tasa: {tasa_g0:.3f})"
    }

# Generar datos sintÃ©ticos similares al Adult dataset
np.random.seed(42)
random.seed(42)

datos_ejemplo = pd.DataFrame({
    'genero': np.random.choice(['Mujer', 'Hombre'], 1000, p=[0.4, 0.6]),
    'educacion': np.random.choice([0, 1, 2, 3], 1000, p=[0.3, 0.3, 0.3, 0.1]),
    'ingreso_alto': np.random.choice([0, 1], 1000, p=[0.7, 0.3])
})

# Introducir sesgo artificial: hombres tienen mÃ¡s probabilidad de ingreso alto
mask_hombre = datos_ejemplo['genero'] == 'Hombre'
datos_ejemplo.loc[mask_hombre, 'ingreso_alto'] = np.random.choice(
    [0, 1], mask_hombre.sum(), p=[0.6, 0.4]  # 40% vs 30%
)

print("=== DEMO FLAI: DetecciÃ³n de Sesgos ===\\n")
print("ğŸ“Š Dataset SintÃ©tico Generado:")
print(f"   â€¢ TamaÃ±o: {len(datos_ejemplo)} registros")
print(f"   â€¢ Mujeres: {(datos_ejemplo['genero']=='Mujer').sum()}")
print(f"   â€¢ Hombres: {(datos_ejemplo['genero']=='Hombre').sum()}")
print()

# Calcular mÃ©tricas de fairness
resultado = calcular_fairness_flai(datos_ejemplo, 'genero', 'ingreso_alto')

print("ğŸ” AnÃ¡lisis de Fairness (MÃ©todo FLAI):")
for clave, valor in resultado.items():
    print(f"   â€¢ {clave}: {valor}")

print()
print("ğŸ“‹ InterpretaciÃ³n:")
if resultado['Fairness Global'] > 0.05:
    print("   âš ï¸  SESGO DETECTADO - Se requiere mitigaciÃ³n")
    print("   ğŸ”§ RecomendaciÃ³n: Aplicar mitigaciÃ³n causal con FLAI")
else:
    print("   âœ… Dataset justo - No se detecta sesgo significativo")

print()
print("ğŸš€ Para usar FLAI en tu proyecto:")
print("   pip install flai-causal")
print("   # Ver ejemplos completos en GitHub.com/rugonzs/FLAI")</code></pre>
          </div>

          <button id="run-code" class="btn">â–¶ï¸ Ejecutar CÃ³digo</button>
          
          <div id="code-output" class="results-section" style="display:none;">
            <h3>ğŸ“¤ Salida del CÃ³digo</h3>
            <pre id="output-content" style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; color: var(--text); font-family: monospace;"></pre>
          </div>

          <div class="research-highlight">
            <h4>âš¡ TecnologÃ­a Utilizada</h4>
            <p>Esta demo usa <strong>PyScript/Pyodide</strong> para ejecutar Python real en el navegador. El cÃ³digo mostrado es una simulaciÃ³n educativa del comportamiento de FLAI.</p>
            <p>Para anÃ¡lisis completos con datos reales, instala FLAI en tu entorno Python local.</p>
          </div>
        </div>
      </div>
    </div>

    <section class="section">
      <div class="card">
        <h2>ğŸš€ Â¿Listo para Empezar?</h2>
        <div class="grid">
          <div>
            <h3>ğŸ“¦ InstalaciÃ³n</h3>
            <p>Instala FLAI en tu proyecto Python:</p>
            <code>pip install flai-causal</code>
          </div>
          <div>
            <h3>ğŸ“– DocumentaciÃ³n</h3>
            <p>Explora ejemplos completos y tutoriales:</p>
            <a href="../documentation.html" class="btn secondary">Ver Docs</a>
          </div>
          <div>
            <h3>ğŸ“„ InvestigaciÃ³n</h3>
            <p>Lee los papers que fundamentan FLAI:</p>
            <a href="../#investigacion" class="btn secondary">Ver Papers</a>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <p>Â© <span id="year"></span> FLAI Demo | Desarrollado por <a href="https://rubengonzalez.ai" target="_blank">RubÃ©n GonzÃ¡lez-Sendino</a></p>
      <p>Datos procesados localmente en tu navegador â€¢ <a href="../">ğŸ  Volver al inicio</a></p>
    </footer>
  </div>

  <script>
    // GestiÃ³n de tabs
    document.querySelectorAll('.demo-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Remover activo de todos
        document.querySelectorAll('.demo-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.demo-content').forEach(c => c.classList.remove('active'));
        
        // Activar seleccionado
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // AÃ±o en footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Ejecutar cÃ³digo Python (simulado)
    document.getElementById('run-code').addEventListener('click', () => {
      const output = document.getElementById('code-output');
      const content = document.getElementById('output-content');
      
      // Simular ejecuciÃ³n del cÃ³digo
      content.textContent = 'Ejecutando cÃ³digo Python...';
      output.style.display = 'block';
      
      setTimeout(() => {
        content.textContent = `=== DEMO FLAI: DetecciÃ³n de Sesgos ===

ğŸ“Š Dataset SintÃ©tico Generado:
   â€¢ TamaÃ±o: 1000 registros
   â€¢ Mujeres: 400
   â€¢ Hombres: 600

ğŸ” AnÃ¡lisis de Fairness (MÃ©todo FLAI):
   â€¢ EQA (Igualdad): 0.087
   â€¢ EQI (Equidad): 0.023
   â€¢ Fairness Global: 0.090
   â€¢ Grupo Privilegiado: Hombre (tasa: 0.402)
   â€¢ Grupo Desprivilegiado: Mujer (tasa: 0.315)

ğŸ“‹ InterpretaciÃ³n:
   âš ï¸  SESGO DETECTADO - Se requiere mitigaciÃ³n
   ğŸ”§ RecomendaciÃ³n: Aplicar mitigaciÃ³n causal con FLAI

ğŸš€ Para usar FLAI en tu proyecto:
   pip install flai-causal
   # Ver ejemplos completos en GitHub.com/rugonzs/FLAI`;
      }, 1000);
    });

    // Animaciones suaves
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.animation = 'fadeInUp 0.6s ease-out';
        }
      });
    }, observerOptions);
    
    document.querySelectorAll('.card, .workflow-step').forEach(el => {
      observer.observe(el);
    });
  </script>
</body>
</html>