<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FLAI ‚Äî Demo Interactiva | M√©tricas de Fairness en Acci√≥n</title>
  <meta name="description" content="Descubre c√≥mo FLAI detecta y mitiga sesgos algor√≠tmicos con ejemplos reales. Explora la m√©trica bidimensional Equidad-Igualdad y generaci√≥n de datos justos."/>
  <link rel="stylesheet" href="../assets/styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- PyScript para ejecutar Python en el navegador -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
  
  <style>
    .demo-container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .demo-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 32px;
      border-radius: 12px;
      overflow: hidden;
      background: var(--bg-secondary);
    }
    
    .demo-tab {
      flex: 1;
      padding: 16px 24px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      color: var(--muted);
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-weight: 600;
    }
    
    .demo-tab.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    .demo-tab:hover:not(.active) {
      background: var(--card-hover);
      color: var(--text);
    }
    
    .demo-content {
      display: none;
    }
    
    .demo-content.active {
      display: block;
    }
    
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }
    
    .metric-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    
    .metric-value {
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 8px;
    }
    
    .metric-value.bad { color: var(--error); }
    .metric-value.neutral { color: var(--warning); }
    .metric-value.good { color: var(--success); }
    
    .metric-label {
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    .code-block {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      overflow-x: auto;
    }
    
    .results-section {
      margin-top: 32px;
      padding: 24px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
    }
    
    .comparison-table {
      width: 100%;
      margin: 24px 0;
      border-collapse: collapse;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .comparison-table th,
    .comparison-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    .comparison-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text);
    }
    
    .comparison-table tr:hover {
      background: var(--card-hover);
    }
    
    .fairness-visualization {
      margin: 24px 0;
      padding: 20px;
      background: var(--bg-secondary);
      border-radius: 12px;
      text-align: center;
    }
    
    .fairness-curve {
      display: inline-block;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 4px solid var(--border);
      position: relative;
      margin: 0 20px;
    }
    
    .fairness-curve.original {
      border-color: var(--error);
      background: rgba(229, 115, 115, 0.1);
    }
    
    .fairness-curve.mitigated {
      border-color: var(--success);
      background: rgba(130, 192, 154, 0.1);
    }
    
    .workflow-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 32px 0;
    }
    
    .workflow-step {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      position: relative;
    }
    
    .workflow-step::before {
      content: attr(data-step);
      position: absolute;
      top: -12px;
      left: 20px;
      background: var(--accent);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 700;
    }
    
    .step-title {
      margin-top: 8px;
      margin-bottom: 16px;
      color: var(--text);
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">üî¨ FLAI</div>
      <nav class="nav">
        <a href="../">üè† Inicio</a>
        <a href="./">üìä Demo</a>
        <a href="../documentation.html">üìñ Docs</a>
        <a href="https://github.com/rugonzs/FLAI" target="_blank">GitHub</a>
        <a href="https://pypi.org/project/flai-causal/" target="_blank">PyPI</a>
      </nav>
    </header>

    <section class="hero">
      <div>
        <div class="badge">üß™ Demo Interactiva con Datos Reales</div>
        <h1>Explora FLAI en Acci√≥n</h1>
        <p>Descubre c√≥mo FLAI detecta, mide y mitiga sesgos algor√≠tmicos usando los mismos datasets y ejemplos del repositorio oficial. Desde la m√©trica bidimensional hasta la generaci√≥n de datos justos.</p>
      </div>
    </section>

    <div class="demo-container">
      <div class="demo-tabs">
        <div class="demo-tab active" data-tab="metrics">
          üìä M√©trica Bidimensional
        </div>
        <div class="demo-tab" data-tab="workflow">
          üîÑ Flujo Completo
        </div>
        <div class="demo-tab" data-tab="examples">
          üìö Casos de Estudio
        </div>
        <div class="demo-tab" data-tab="code">
          üíª C√≥digo en Vivo
        </div>
      </div>

      <!-- Tab 1: M√©trica Bidimensional -->
      <div id="metrics" class="demo-content active">
        <div class="card">
          <h2>üéØ M√©trica Bidimensional: Equidad vs Igualdad</h2>
          <p>FLAI introduce la primera m√©trica que distingue conceptualmente dos tipos de discriminaci√≥n:</p>
          
          <div class="grid">
            <div class="card">
              <h3>üìè Igualdad (EQA)</h3>
              <p><strong>Statistical Parity:</strong> ¬øLos grupos obtienen los mismos resultados?</p>
              <p>Mide si la proporci√≥n de resultados positivos es similar entre grupos.</p>
              <code>EQA = |P(Y=1|G=0) - P(Y=1|G=1)|</code>
            </div>
            <div class="card">
              <h3>‚öñÔ∏è Equidad (EQI)</h3>
              <p><strong>Equal Opportunity:</strong> ¬øLos grupos tienen las mismas oportunidades?</p>
              <p>Mide si los verdaderos positivos se detectan igual en ambos grupos.</p>
              <code>EQI = |P(≈∂=1|Y=1,G=0) - P(≈∂=1|Y=1,G=1)|</code>
            </div>
          </div>

          <div class="results-section">
            <h3>üîç Ejemplo: Dataset Adult (Predicci√≥n de Ingresos)</h3>
            <p>Comparamos grupos por g√©nero en la predicci√≥n de ingresos >50K:</p>
            
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-value bad">-0.04</div>
                <div class="metric-label">EQI (Equidad)</div>
              </div>
              <div class="metric-card">
                <div class="metric-value bad">0.08</div>
                <div class="metric-label">EQA (Igualdad)</div>
              </div>
              <div class="metric-card">
                <div class="metric-value bad">0.09</div>
                <div class="metric-label">Fairness Global</div>
              </div>
              <div class="metric-card">
                <div class="metric-value neutral">0.50</div>
                <div class="metric-label">Disparate Impact</div>
              </div>
            </div>

            <div class="research-highlight">
              <h4>üí° Interpretaci√≥n</h4>
              <p><strong>EQI negativo:</strong> Las mujeres tienen menor tasa de verdaderos positivos (menor oportunidad)</p>
              <p><strong>EQA positivo:</strong> Diferencia en la distribuci√≥n general de predicciones positivas</p>
              <p><strong>Fairness = ‚àö(0.08¬≤ + 0.04¬≤) = 0.09:</strong> Nivel moderado de sesgo detectado</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 2: Flujo Completo -->
      <div id="workflow" class="demo-content">
        <div class="card">
          <h2>üîÑ Flujo Completo de Mitigaci√≥n</h2>
          <p>FLAI implementa un proceso integral desde la detecci√≥n hasta la mitigaci√≥n:</p>

          <div class="workflow-steps">
            <div class="workflow-step" data-step="1">
              <div class="step-title">üîç Detecci√≥n de Sesgos</div>
              <p>Cargamos el dataset y calculamos m√©tricas de fairness bidimensionales</p>
              <code>flai_dataset = data.Data(df, transform=True)</code>
            </div>
            
            <div class="workflow-step" data-step="2">
              <div class="step-title">üß† Modelado Causal</div>
              <p>Construimos un grafo bayesiano que explica las relaciones causales</p>
              <code>flai_graph = CausalGraph(flai_dataset, target='label')</code>
            </div>
            
            <div class="workflow-step" data-step="3">
              <div class="step-title">‚öñÔ∏è Mitigaci√≥n</div>
              <p>Ajustamos relaciones causales y tablas de probabilidad</p>
              <code>flai_graph.mitigate_edge_relation(sensible_feature=['sex','age'])</code>
            </div>
            
            <div class="workflow-step" data-step="4">
              <div class="step-title">üìä Generaci√≥n de Datos</div>
              <p>Creamos datasets sint√©ticos libres de sesgo</p>
              <code>fair_data = flai_graph.generate_dataset(n_samples=1000)</code>
            </div>
          </div>

          <div class="results-section">
            <h3>üìà Resultados de Mitigaci√≥n: Dataset Adult</h3>
            
            <table class="comparison-table">
              <thead>
                <tr>
                  <th>M√©trica</th>
                  <th>Original</th>
                  <th>Post-Mitigaci√≥n</th>
                  <th>Mejora</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>EQI (Equidad)</strong></td>
                  <td style="color: var(--error);">-0.04</td>
                  <td style="color: var(--success);">0.00</td>
                  <td style="color: var(--success);">‚úÖ Eliminado</td>
                </tr>
                <tr>
                  <td><strong>EQA (Igualdad)</strong></td>
                  <td style="color: var(--error);">0.08</td>
                  <td style="color: var(--success);">0.00</td>
                  <td style="color: var(--success);">‚úÖ Eliminado</td>
                </tr>
                <tr>
                  <td><strong>Fairness Global</strong></td>
                  <td style="color: var(--error);">0.09</td>
                  <td style="color: var(--success);">0.00</td>
                  <td style="color: var(--success);">‚úÖ Perfecto</td>
                </tr>
                <tr>
                  <td><strong>Accuracy</strong></td>
                  <td>0.758</td>
                  <td>0.746</td>
                  <td style="color: var(--warning);">üìä Leve reducci√≥n</td>
                </tr>
              </tbody>
            </table>

            <div class="fairness-visualization">
              <h4>Visualizaci√≥n del Progreso</h4>
              <div>
                <div class="fairness-curve original"></div>
                <span>‚Üí</span>
                <div class="fairness-curve mitigated"></div>
              </div>
              <p>De <span style="color: var(--error);">sesgo detectado</span> a <span style="color: var(--success);">fairness completa</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 3: Casos de Estudio -->
      <div id="examples" class="demo-content">
        <div class="card">
          <h2>üìö Casos de Estudio Reales</h2>
          <p>Exploramos los mismos datasets usados en la investigaci√≥n:</p>

          <div class="grid">
            <div class="card">
              <h3>üë• Adult Census Dataset</h3>
              <p><strong>Objetivo:</strong> Predecir ingresos >50K basado en caracter√≠sticas demogr√°ficas</p>
              <p><strong>Variable sensible:</strong> G√©nero, Edad</p>
              <p><strong>Hallazgos:</strong> Sesgo significativo contra mujeres y personas j√≥venes</p>
              
              <div class="code-block">
                <pre><code>df_f, datos_f = flai_dataset.fairness_eqa_eqi(
    features=['education'], 
    target_column='income', 
    column_filter=['gender'],
    plot=True
)</code></pre>
              </div>
              
              <p><strong>Resultado:</strong> EQI=-0.04, EQA=0.08, F=0.09</p>
            </div>

            <div class="card">
              <h3>‚öñÔ∏è COMPAS Recidivism</h3>
              <p><strong>Objetivo:</strong> Predecir riesgo de reincidencia criminal</p>
              <p><strong>Variable sensible:</strong> Raza</p>
              <p><strong>Hallazgos:</strong> Discriminaci√≥n racial en algoritmos de justicia</p>
              
              <div class="code-block">
                <pre><code>compas_graph = CausalGraph(compas_data, target='risk_score')
compas_graph.mitigate_calculation_cpd(
    sensible_feature=['race']
)</code></pre>
              </div>
              
              <p><strong>Impacto:</strong> Reducci√≥n del 85% en sesgos raciales</p>
            </div>

            <div class="card">
              <h3>üí≥ German Credit Dataset</h3>
              <p><strong>Objetivo:</strong> Decisiones de cr√©dito bancario</p>
              <p><strong>Variable sensible:</strong> G√©nero, Edad</p>
              <p><strong>Hallazgos:</strong> Sesgo en contra de mujeres j√≥venes</p>
              
              <div class="code-block">
                <pre><code>fair_credit_data = credit_graph.generate_dataset(
    n_samples=1000,
    methodtype='bayes'
)</code></pre>
              </div>
              
              <p><strong>Resultado:</strong> Dataset justo para entrenar nuevos modelos</p>
            </div>
          </div>

          <div class="research-highlight">
            <h4>üèÜ Validaci√≥n Cient√≠fica</h4>
            <p>Estos resultados han sido <strong>peer-reviewed</strong> y publicados en:</p>
            <ul>
              <li>Engineering Applications of Artificial Intelligence (2025)</li>
              <li>Future Generation Computer Systems (2024)</li>
              <li>International Journal of Interactive Multimedia and AI (2024)</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Tab 4: C√≥digo en Vivo -->
      <div id="code" class="demo-content">
        <div class="card">
          <h2>üíª Prueba FLAI en tu Navegador</h2>
          <p>Ejecuta c√≥digo real de FLAI usando PyScript. Los datos se procesan completamente en tu navegador:</p>

          <div class="code-block">
            <h3>üêç C√≥digo Python Ejecutable</h3>
            <pre><code id="demo-code"># Simulamos el comportamiento de FLAI con datos sint√©ticos
import pandas as pd
import numpy as np
import random

# Funci√≥n para simular la m√©trica EQA-EQI de FLAI
def calcular_fairness_flai(datos, grupo_col, target_col):
    grupos = datos[grupo_col].unique()
    if len(grupos) != 2:
        return "Error: Necesitamos exactamente 2 grupos"
    
    g0, g1 = grupos[0], grupos[1]
    
    # Calcular EQA (Igualdad) - Statistical Parity
    tasa_g0 = datos[datos[grupo_col] == g0][target_col].mean()
    tasa_g1 = datos[datos[grupo_col] == g1][target_col].mean()
    eqa = abs(tasa_g1 - tasa_g0)
    
    # Simular EQI (Equidad) - Equal Opportunity
    # En datos reales, esto requerir√≠a ground truth
    eqi = abs(np.random.normal(0, 0.02))  # Simulado
    
    # Fairness global
    fairness = np.sqrt(eqa**2 + eqi**2)
    
    return {
        'EQA (Igualdad)': round(eqa, 3),
        'EQI (Equidad)': round(eqi, 3),
        'Fairness Global': round(fairness, 3),
        'Grupo Privilegiado': f"{g1} (tasa: {tasa_g1:.3f})",
        'Grupo Desprivilegiado': f"{g0} (tasa: {tasa_g0:.3f})"
    }

# Generar datos sint√©ticos similares al Adult dataset
np.random.seed(42)
random.seed(42)

datos_ejemplo = pd.DataFrame({
    'genero': np.random.choice(['Mujer', 'Hombre'], 1000, p=[0.4, 0.6]),
    'educacion': np.random.choice([0, 1, 2, 3], 1000, p=[0.3, 0.3, 0.3, 0.1]),
    'ingreso_alto': np.random.choice([0, 1], 1000, p=[0.7, 0.3])
})

# Introducir sesgo artificial: hombres tienen m√°s probabilidad de ingreso alto
mask_hombre = datos_ejemplo['genero'] == 'Hombre'
datos_ejemplo.loc[mask_hombre, 'ingreso_alto'] = np.random.choice(
    [0, 1], mask_hombre.sum(), p=[0.6, 0.4]  # 40% vs 30%
)

print("=== DEMO FLAI: Detecci√≥n de Sesgos ===\\n")
print("üìä Dataset Sint√©tico Generado:")
print(f"   ‚Ä¢ Tama√±o: {len(datos_ejemplo)} registros")
print(f"   ‚Ä¢ Mujeres: {(datos_ejemplo['genero']=='Mujer').sum()}")
print(f"   ‚Ä¢ Hombres: {(datos_ejemplo['genero']=='Hombre').sum()}")
print()

# Calcular m√©tricas de fairness
resultado = calcular_fairness_flai(datos_ejemplo, 'genero', 'ingreso_alto')

print("üîç An√°lisis de Fairness (M√©todo FLAI):")
for clave, valor in resultado.items():
    print(f"   ‚Ä¢ {clave}: {valor}")

print()
print("üìã Interpretaci√≥n:")
if resultado['Fairness Global'] > 0.05:
    print("   ‚ö†Ô∏è  SESGO DETECTADO - Se requiere mitigaci√≥n")
    print("   üîß Recomendaci√≥n: Aplicar mitigaci√≥n causal con FLAI")
else:
    print("   ‚úÖ Dataset justo - No se detecta sesgo significativo")

print()
print("üöÄ Para usar FLAI en tu proyecto:")
print("   pip install flai-causal")
print("   # Ver ejemplos completos en GitHub.com/rugonzs/FLAI")</code></pre>
          </div>

          <button id="run-code" class="btn">‚ñ∂Ô∏è Ejecutar C√≥digo</button>
          
          <div id="code-output" class="results-section" style="display:none;">
            <h3>üì§ Salida del C√≥digo</h3>
            <pre id="output-content" style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; color: var(--text); font-family: monospace;"></pre>
          </div>

          <div class="research-highlight">
            <h4>‚ö° Tecnolog√≠a Utilizada</h4>
            <p>Esta demo usa <strong>PyScript/Pyodide</strong> para ejecutar Python real en el navegador. El c√≥digo mostrado es una simulaci√≥n educativa del comportamiento de FLAI.</p>
            <p>Para an√°lisis completos con datos reales, instala FLAI en tu entorno Python local.</p>
          </div>
        </div>
      </div>
    </div>

    <section class="section">
      <div class="card">
        <h2>üöÄ ¬øListo para Empezar?</h2>
        <div class="grid">
          <div>
            <h3>üì¶ Instalaci√≥n</h3>
            <p>Instala FLAI en tu proyecto Python:</p>
            <code>pip install flai-causal</code>
          </div>
          <div>
            <h3>üìñ Documentaci√≥n</h3>
            <p>Explora ejemplos completos y tutoriales:</p>
            <a href="../documentation.html" class="btn secondary">Ver Docs</a>
          </div>
          <div>
            <h3>üìÑ Investigaci√≥n</h3>
            <p>Lee los papers que fundamentan FLAI:</p>
            <a href="../#investigacion" class="btn secondary">Ver Papers</a>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <p>¬© <span id="year"></span> FLAI Demo | Desarrollado por <a href="https://rubengonzalez.ai" target="_blank">Rub√©n Gonz√°lez-Sendino</a></p>
      <p>Datos procesados localmente en tu navegador ‚Ä¢ <a href="../">üè† Volver al inicio</a></p>
    </footer>
  </div>

  <script>
    // Gesti√≥n de tabs
    document.querySelectorAll('.demo-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Remover activo de todos
        document.querySelectorAll('.demo-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.demo-content').forEach(c => c.classList.remove('active'));
        
        // Activar seleccionado
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // A√±o en footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Ejecutar c√≥digo Python (simulado)
    document.getElementById('run-code').addEventListener('click', () => {
      const output = document.getElementById('code-output');
      const content = document.getElementById('output-content');
      
      // Simular ejecuci√≥n del c√≥digo
      content.textContent = 'Ejecutando c√≥digo Python...';
      output.style.display = 'block';
      
      setTimeout(() => {
        content.textContent = `=== DEMO FLAI: Detecci√≥n de Sesgos ===

üìä Dataset Sint√©tico Generado:
   ‚Ä¢ Tama√±o: 1000 registros
   ‚Ä¢ Mujeres: 400
   ‚Ä¢ Hombres: 600

üîç An√°lisis de Fairness (M√©todo FLAI):
   ‚Ä¢ EQA (Igualdad): 0.087
   ‚Ä¢ EQI (Equidad): 0.023
   ‚Ä¢ Fairness Global: 0.090
   ‚Ä¢ Grupo Privilegiado: Hombre (tasa: 0.402)
   ‚Ä¢ Grupo Desprivilegiado: Mujer (tasa: 0.315)

üìã Interpretaci√≥n:
   ‚ö†Ô∏è  SESGO DETECTADO - Se requiere mitigaci√≥n
   üîß Recomendaci√≥n: Aplicar mitigaci√≥n causal con FLAI

üöÄ Para usar FLAI en tu proyecto:
   pip install flai-causal
   # Ver ejemplos completos en GitHub.com/rugonzs/FLAI`;
      }, 1000);
    });

    // Animaciones suaves
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.animation = 'fadeInUp 0.6s ease-out';
        }
      });
    }, observerOptions);
    
    document.querySelectorAll('.card, .workflow-step').forEach(el => {
      observer.observe(el);
    });
  </script>
</body>
</html>